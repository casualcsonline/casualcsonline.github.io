<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.81.0"><link rel="shortcut icon" href=https://cdn.jsdelivr.net/gh/dsrkafuu/dsr-cdn@1/images/favicons/dsrca/favicon.ico><title>Docker 101 - Casual Computer Science Explanations</title><meta name=description content="Computer Science, Explained Casually"><meta name=keywords content="docker,containers,intro"><meta property="og:title" content="Docker 101"><meta name=twitter:title content="Docker 101"><meta property="og:type" content="article"><meta property="og:url" content="https://casualcs.dev/posts/docker/"><meta property="og:description" content="I&rsquo;ve recently had a handful of discussions with folks about what Docker is and how it works. The world definitely needs another &ldquo;getting started with docker&rdquo; guide, and I figured it was high time I write one up too."><meta name=twitter:description content="I&rsquo;ve recently had a handful of discussions with folks about what Docker is and how it works. The world definitely needs another &ldquo;getting started with docker&rdquo; guide, and I figured it was high time I write one up too."><meta name=twitter:card content="summary"><meta property="article:published_time" content="2021-02-24T11:24:33-08:00"><meta property="article:modified_time" content="2021-02-24T11:24:33-08:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://casualcs.dev/assets/css/fuji.min.css></head><body data-theme=auto><script data-cfasync=false>var fujiThemeData=localStorage.getItem('fuji_data-theme');fujiThemeData?fujiThemeData!=='auto'&&document.body.setAttribute('data-theme',fujiThemeData==='dark'?'dark':'light'):localStorage.setItem('fuji_data-theme','auto')</script><header><div class="container-lg clearfix"><div class="col-12 header"><a class=title-main href=https://casualcs.dev/>Casual Computer Science Explanations</a></div></div></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h2 class="post-item post-title"><a href=https://casualcs.dev/posts/docker/>Docker 101</a></h2><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-02-24</span><span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;1884 words</span><span><i class="iconfont icon-time-sharp"></i>&nbsp;9 minutes</span><span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/docker>docker</a>&nbsp;<a href=/tags/containers>containers</a>&nbsp;<a href=/tags/intro>intro</a>&nbsp;</span></div><div class="post-content markdown-body"><p>I&rsquo;ve recently had a handful of discussions with folks about what Docker is and how it works. The world <strong>definitely</strong> needs another &ldquo;getting started with docker&rdquo; guide, and I figured it was high time I write one up too.</p><h2 id=what-well-cover>What We&rsquo;ll Cover</h2><p>By the end of this article, you should have a decent grasp of how Docker images and containers work under the hood. We&rsquo;ll cover:</p><ul><li>How a docker container works.</li><li>The relationship between a docker image and a docker container.</li><li>Why Docker might be helpful for you.</li><li>How to create a basic docker image.</li></ul><h2 id=what-we-wont-cover>What We Won&rsquo;t Cover</h2><ul><li>How Docker works for networks, and how containers can talk to each other.</li><li>How the Docker Daemon actually runs containers. We won&rsquo;t even explain what the Docker Daemon is.</li><li>Any information about other container runtimes.</li><li>How any of this works on operating systems that aren&rsquo;t linux.</li></ul><h2 id=definitions>Definitions</h2><p>Before we dive in too deeply, let&rsquo;s make sure we&rsquo;re all speaking the same language.</p><dl><dt>Image</dt><dd>An &ldquo;Image&rdquo; is a cookie cutter for a docker container. When you have an image, you can stamp out as many containers based on that image as you like.</dd><dt>Container</dt><dd>A &ldquo;Container&rdquo; is an instance of your &ldquo;Image&rdquo;. Following the &ldquo;cookie cutter&rdquo; comparison, this is a single cookie. It may look and act like all of the other cookies on your baking sheet, but it acts as its own independent morsel.</dd><dt>Dockerfile</dt><dd>A set of instructions to create an &ldquo;Image&rdquo;. Think of it like a cookie recipe.</dd><dt>Namespace</dt><dd>A &ldquo;Namespace&rdquo; is a way to isolate your cookies from your neighbor&rsquo;s cookies. Everything we need to know about our delicious chocolate chip cookies are contained in a set of namespaces, and within our namespaces we don&rsquo;t even know that Jim&rsquo;s oatmeal raisin cookies exist.</dd><dt>Container Runtime</dt><dd>Really, Docker is just one type of &ldquo;Container Runtime&rdquo;. Much like you can write the same program in almost any language, you can create and run containers in several different runtimes. For today, we&rsquo;ll acknowledge that these other runtimes exist and then go right back to ignoring them.</dd></dl><h2 id=what-is-docker-really>What is Docker, really?</h2><p>The thing we know as &ldquo;Docker&rdquo; is just some fancy UX around a technology known as Namespaces. Namespaces are, basically, boxes made of fancy one-way mirrors. When you put things in this box, they can&rsquo;t see out and only things that aren&rsquo;t in other boxes can see in.</p><p>Docker does a great job of combining a few types of boxes and making it easy for us to put things in them. The main box we&rsquo;re concerned with today is known as a &ldquo;process namespace&rdquo; - any running process in this box is only aware of other processes if they&rsquo;re also inside of this box. We&rsquo;ll also talk about a &ldquo;mount namespace&rdquo; or &ldquo;filesystem namespace&rdquo;<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> - any running process in this box is only aware of files that we&rsquo;ve placed inside of this box.</p><p>Let&rsquo;s go back to our cookie cutter example. If a docker image is a cookie cutter, than a computer is made up of cookie dough. We can take our cookie cutter and stamp it down on our cookie dough and BAM, we have a gingerbread person. Likewise, we can take our docker image and stamp it down on our computer and BAM we have a container with its associated process and filesystem namespaces. If we take our cookie cutter and put it away for the season<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, we can take it out again next year and stamp it down <em>in a new batch of dough</em> and get <em>a gingerbread person of the exact same shape</em>. Likewise, we can take our docker image over to somebody else&rsquo;s computer and run a container <em>that looks exactly the same</em>.</p><h3 id=how-is-this-different-from-a-virtual-machine>How is this different from a virtual machine?</h3><p>Sticking with our analogy, starting a virtual machine is like creating a whole new batch of cookie dough. A docker image assumes you already have some cookie dough around, and is happy to make use of what you&rsquo;ve got.</p><p>The big impact here is that it&rsquo;s <em>wicked</em> fast to start up a container from an image, whereas starting a virtual machine takes a fair bit of time. Containers also require far fewer resources than virtual machines, since they play nicely with the operating system they&rsquo;re running under rather than having to create an entirely new operating system.</p><h2 id=why-does-any-of-this-matter>Why does any of this matter?</h2><p>I think that the most compelling reason to start using docker is that it makes it trivial to run your code in different places without any changes. If you have a docker image that works on your computer, it&rsquo;ll almost certainly work on somebody else&rsquo;s computer as well.</p><p>This means no more mucking around with code dependencies when you try to run your code somewhere else. So long as you&rsquo;ve set up your cookie cutter docker image with the versions of the dependencies you need, you can stamp out a docker container on another machine and have it start right up.</p><h2 id=your-first-image-and-container>Your first image and container</h2><p>The starting point for any image is called a <code>Dockerfile</code>. It acts as the recipe for your cookies, and can be used to make cookie dough whenever you like. From this <code>Dockerfile</code>, we can create a docker Image that we&rsquo;ll eventually run as a docker Container.</p><h3 id=the-dockerfile>The Dockerfile</h3><p>Let&rsquo;s set up a basic dockerfile and walk through what happens:</p><pre><code class=language-dockerfile>FROM ubuntu             # Line 1
ENTRYPOINT [&quot;cat&quot;]      # Line 2
CMD [&quot;/etc/issue&quot;]      # Line 3
</code></pre><p>On Line 1, we specify a jumping off point for our recipe. This is like saying &ldquo;go get some flour and some chocolate chips&rdquo; - you don&rsquo;t need to grow wheat or cacao trees, you just need some of the finished products so you can combine them in a way you like.</p><p>On Line 2, we tell the image what the container should do when it starts up. This is like preheating your oven - get some things set up so you can get your cookies baking easily. Note that the <strong>Image</strong> <em>doesn&rsquo;t actually run this command</em>. It just tells sets us up so that when we eventually create a <strong>Container</strong> from this Image, that <strong>Container</strong> will run this command.</p><p>On Line 3, we specify some default arguments that will be passed to our Entrypoint when the Container eventually starts. These arguments can be overriden by the Container when it starts up. In this particular instance, I&rsquo;ve chosen the name of the first file I can think of that will definitely exist in this image<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> - there&rsquo;s nothing special about this particular file.</p><h3 id=from-a-dockerfile-to-a-docker-image>From a Dockerfile to a Docker Image</h3><p>To create an <strong>Image</strong> from this <code>Dockerfile</code>, we&rsquo;ll run the following in our shell. If you want to actually run it, you&rsquo;ll likely have to remove the comments:</p><pre><code class=language-bash>docker build \              # Line 1
    --file Dockerfile \     # Line 2
    --tag chocolatechip \   # Line 3
    .                       # Line 4
</code></pre><p>On Line 1, we tell docker we want to build some stuff.</p><p>On Line 2, we tell docker the recipe we want to build from. <code>Dockerfile</code> is actually the default here, so we don&rsquo;t <em>have</em> to say this, but I like being explicit.</p><p>On Line 3, we tell docker what we want to &ldquo;tag&rdquo;, or &ldquo;name&rdquo; the resulting image.</p><p>On Line 4, we tell docker the &ldquo;context&rdquo; we want to use to build our image. We&rsquo;re going to gloss over this - just use <code>.</code> (the current directory) for now.</p><p>When you run the command, you&rsquo;ll see output very similar to the following:</p><pre><code>❯ docker build --file Dockerfile --tag chocolatechip .
Sending build context to Docker daemon  2.048kB
Step 1/3 : FROM ubuntu
latest: Pulling from library/ubuntu
83ee3a23efb7: Pull complete
db98fc6f11f0: Pull complete
f611acd52c6c: Pull complete
Digest: sha256:703218c0465075f4425e58fac086e09e1de5c340b12976ab9eb8ad26615c3715
Status: Downloaded newer image for ubuntu:latest
 ---&gt; f63181f19b2f
Step 2/3 : ENTRYPOINT [&quot;cat&quot;]
 ---&gt; Running in 6216f1bc7328
Removing intermediate container 6216f1bc7328
 ---&gt; 16e1ee9a39fb
Step 3/3 : CMD [&quot;/etc/issue&quot;]
 ---&gt; Running in b50691f519fd
Removing intermediate container b50691f519fd
 ---&gt; d9c66e31bdfa
Successfully built d9c66e31bdfa
Successfully tagged chocolatechip:latest
</code></pre><p>We now have a docker image called <code>chocolatechip</code>! Notice that each Step corresponds to a line in our <code>Dockerfile</code>. Also notice that the very first step resulted in some stuff being &ldquo;Pulled&rdquo; - this is docker going to the grocery store to buy flour and chocolate chips.</p><h3 id=from-a-docker-image-to-docker-containers>From a Docker Image to Docker Containers</h3><p>Now that we have a docker image, we can run it as many times as we like:</p><pre><code>❯ docker run chocolatechip
Ubuntu 20.04.1 LTS \n \l

❯ docker run chocolatechip
Ubuntu 20.04.1 LTS \n \l

❯ docker run chocolatechip
Ubuntu 20.04.1 LTS \n \l

❯ docker run chocolatechip
Ubuntu 20.04.1 LTS \n \l
</code></pre><p>Each time, the output is identical to the previous time. The command also completes nearly instantly! All of the hard work of going to get flour and chocolate chips is already done - we just have to stamp out cookies.</p><p>Now we can check to see that we actually made a bunch of different cookies:</p><pre><code>❯ docker ps --all  # List all containers that are running or have run in the past
CONTAINER ID   IMAGE           COMMAND            CREATED              STATUS                          PORTS     NAMES
e969783110b9   chocolatechip   &quot;cat /etc/issue&quot;   About a minute ago   Exited (0) About a minute ago             reverent_williams
9df76df03001   chocolatechip   &quot;cat /etc/issue&quot;   About a minute ago   Exited (0) About a minute ago             pedantic_keller
caebbe2d859a   chocolatechip   &quot;cat /etc/issue&quot;   About a minute ago   Exited (0) About a minute ago             xenodochial_johnson
96f65378d930   chocolatechip   &quot;cat /etc/issue&quot;   About a minute ago   Exited (0) About a minute ago             jolly_neumann
a71ff73e2c32   chocolatechip   &quot;cat /etc/issue&quot;   About a minute ago   Exited (0) About a minute ago             jovial_wescoff 
</code></pre><p>We have a bunch of different containers that are all based on our <code>chocolatechip</code> image, and have run the same COMMAND - <code>cat /etc/issue</code>, a combination of the <code>ENTRYPOINT</code> and <code>CMD</code> steps from <code>Dockerfile</code>, just as we expected.</p><h3 id=doing-something-slightly-different>Doing something slightly different</h3><p>Now that we have our <code>chocolatechip</code> cookie cutter, we might want to deviate <em>just a little bit</em> from our main shape - add some sprinkles or something. That&rsquo;s why we specified the file we wanted to view as a <code>CMD</code>. We can swap out the <code>CMD</code> by passing some more arguments to <code>docker run</code>:</p><pre><code>❯ docker run chocolatechip /etc/debian_version
bullseye/sid
</code></pre><p>And listing our docker containers again:</p><pre><code>❯ docker ps --all
CONTAINER ID   IMAGE           COMMAND                  CREATED              STATUS                        PORTS     NAMES
fd6f86dd15a2   chocolatechip   &quot;cat /etc/debian_ver…&quot;   18 seconds ago       Exited (0) 18 seconds ago               jolly_solomon
e969783110b9   chocolatechip   &quot;cat /etc/issue&quot;         6 minutes ago        Exited (0) 6 minutes ago                reverent_williams
9df76df03001   chocolatechip   &quot;cat /etc/issue&quot;         6 minutes ago        Exited (0) 6 minutes ago                pedantic_keller
caebbe2d859a   chocolatechip   &quot;cat /etc/issue&quot;         6 minutes ago        Exited (0 6 minutes ago                 xenodochial_johnson
96f65378d930   chocolatechip   &quot;cat /etc/issue&quot;         6 minutes ago        Exited (0) 6 minutes ago                jolly_neumann
a71ff73e2c32   chocolatechip   &quot;cat /etc/issue&quot;         7 minutes ago        Exited (0) 7 minutes ago                jovial_wescoff
</code></pre><p>And we see that we have a new container, still based on our <code>chocolatechip</code> cookie cutter image, but doing something just <em>slightly</em> different.</p><h2 id=wrap-up>Wrap Up</h2><p>And that&rsquo;s our whirlwind tour of <del>baking</del> docker!</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>While I can&rsquo;t find any evidence that the term &ldquo;filesystem namespace&rdquo; is <em>wrong</em>, I also can&rsquo;t find any that it&rsquo;s <em>correct</em>. It doesn&rsquo;t require me to explain what a &ldquo;mount&rdquo; is though, so I&rsquo;m sticking with it. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Cookie Cutters are only useful in December, right? <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>I want you to be able to run the examples I show here <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><div class=post-comment data-comment=utterances><span class=post-comment-notloaded><i class="iconfont icon-chatbox-ellipses-sharp"></i>&nbsp;Load comments</span>
<script>function loadComment(){var c=document.querySelector('.post-comment'),b=document.body.getAttribute('data-theme'),a;b==='auto'?b=window.matchMedia('(prefers-color-scheme: dark)').matches?'photon-dark':'github-light':b=b==='dark'?'photon-dark':'github-light',a=document.createElement('script'),a.src='https://utteranc.es/client.js',a.setAttribute('repo','casualcsonline/casualcsonline.github.io'),a.setAttribute('issue-term','og:title'),a.setAttribute('theme',b),a.setAttribute('crossorigin','anonymous'),a.setAttribute('async',''),document.querySelector('.post-comment').appendChild(a),document.querySelector('span.post-comment-notloaded').setAttribute('style','display: none;')}</script></div></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>Links</h3><ul></ul></div><div class="sidebar-item sidebar-tags"><h3>Tags</h3><div><span><a href=/tags/containers/>containers</a></span>
<span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/intro/>intro</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>TOC</h3><nav id=TableOfContents><ul><li><a href=#what-well-cover>What We&rsquo;ll Cover</a></li><li><a href=#what-we-wont-cover>What We Won&rsquo;t Cover</a></li><li><a href=#definitions>Definitions</a></li><li><a href=#what-is-docker-really>What is Docker, really?</a><ul><li><a href=#how-is-this-different-from-a-virtual-machine>How is this different from a virtual machine?</a></li></ul></li><li><a href=#why-does-any-of-this-matter>Why does any of this matter?</a></li><li><a href=#your-first-image-and-container>Your first image and container</a><ul><li><a href=#the-dockerfile>The Dockerfile</a></li><li><a href=#from-a-dockerfile-to-a-docker-image>From a Dockerfile to a Docker Image</a></li><li><a href=#from-a-docker-image-to-docker-containers>From a Docker Image to Docker Containers</a></li><li><a href=#doing-something-slightly-different>Doing something slightly different</a></li></ul></li><li><a href=#wrap-up>Wrap Up</a></li></ul></nav></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/index.xml>RSS</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>Links</h3><ul></ul></div><div class="sidebar-item sidebar-tags"><h3>Tags</h3><div><span><a href=/tags/containers/>containers</a></span>
<span><a href=/tags/docker/>docker</a></span>
<span><a href=/tags/intro/>intro</a></span></div></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2021-2021
<a href=https://casualcs.dev/></a>| <a href=https://github.com/casualcsonline/casualcsonline.github.io>Source code</a>
| Powered by <a href=https://github.com/dsrkafuu/hugo-theme-fuji/ target=_blank>Fuji-v2</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js></script><script defer src=/assets/js/fuji.min.js></script></body></html>